!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.DzhyunConnection=t():e.DzhyunConnection=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t,n){var r=/^((\w+):\/\/)?(.*)/.exec(e),o=i(r,4),u=o[2],s=void 0===u?"http":u,c=o[3],f=a[s];if(!f)throw new Error('protocol "'+s+'" no support');return f(c,t,n)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&a.return&&a.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t,n,i,u){if(r(this,e),"string"!=typeof t)throw new Error("address is incorrect");if(this.constructor===e)return o(t,n,i);this._address=t,this.options=n||{},"boolean"==typeof i?(this._secure=i,this._handler=null):(this._secure=u||!1,this._handler=i),this._protocol="http",this._listenerMap={}}return u(e,[{key:"getAddress",value:function(){return this.getProtocol()+"://"+this._address.replace(/^(\w+:\/\/)?/,"")}},{key:"getProtocol",value:function(){return this._protocol+(this._secure?"s":"")}},{key:"request",value:function(e,t){}},{key:"send",value:function(e,t){return this.request(e,t)}},{key:"close",value:function(){}},{key:"on",value:function(e,t){if("function"==typeof t){var n=this._listenerMap[e]||(this._listenerMap[e]=[]);n.indexOf(t)<0&&n.push(t)}return this}},{key:"off",value:function(e,t){if("function"==typeof t){var n=this._listenerMap[e]||(this._listenerMap[e]=[]),r=n.indexOf(t);r>=0&&n.splice(r,1)}return this}},{key:"trigger",value:function(e){for(var t,n=this,r=arguments.length,o=Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];var u=this._listenerMap[e];return u&&u.forEach(function(e){return e.apply(n,o)}),this._handler&&"function"==typeof this._handler[e]&&(t=this._handler)[e].apply(t,o),this}}]),e}();a.EVENT_OPEN="open",a.EVENT_CLOSE="close",a.EVENT_ERROR="error",a.EVENT_REQUEST="request",a.EVENT_SEND="send",a.EVENT_RESPONSE="response",a.EVENT_MESSAGE="message",a.EVENT_PROGRESS="progress",t.default=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),c=r(s),f=n(4),l=r(f),p=function(e){function t(){var e;o(this,t);for(var n=arguments.length,r=Array(n),u=0;u<n;u++)r[u]=arguments[u];var a=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r)));return a._request=[],a}return u(t,e),a(t,[{key:"request",value:function(e,t){var n=this,r=Object.assign({},this.options,t),o=void 0;return r.success=function(e){n.trigger(c.default.EVENT_MESSAGE,e),n.trigger(c.default.EVENT_RESPONSE,e)},r.error=function(e,t,r){n.trigger(c.default.EVENT_ERROR,r)},r.complete=function(){var e=n._request.indexOf(o);n._request.splice(e,1)},r.url=this.getAddress()+(e||""),o=(0,l.default)(r),o&&(o.onreadystatechange=function(t){return function(){2===o.readyState&&(n.trigger(c.default.EVENT_SEND,e),n.trigger(c.default.EVENT_REQUEST,e)),t&&t()}}(o.onreadystatechange)),this.trigger(c.default.EVENT_OPEN),this._request.push(o),o.onprogress=function(e){n.trigger(c.default.EVENT_PROGRESS,e)},this}},{key:"close",value:function(){var e=this;return this._request.forEach(function(t,n){t.abort(),e._request.splice(n,1)}),this.trigger(c.default.EVENT_CLOSE),this}}]),t}(c.default);c.default.http=function(e,t,n){return new p(e,t,n,!1)},c.default.https=function(e,t,n){return new p(e,t,n,!0)},e.exports=c.default},,,function(e,t,n){"use strict";function r(e){if("undefined"==typeof ArrayBuffer)throw new Error("不支持ArrayBuffer类型");if(e.response instanceof ArrayBuffer)return e.response;for(var t=e.responseText,n=t.length,r=new ArrayBuffer(n),o=new Uint8Array(r),i=0;i<n;i+=1)o[i]=255&t.charCodeAt(i);return r}function o(e){if("undefined"==typeof Blob)throw new Error("不支持Blob类型");if(e.response instanceof Blob)return e.response;var t=r(e);return new Blob([t])}function i(e,t,n){return!0}function u(e,t,n,r){if(e.global)return i(t||S,n,r)}function a(e){e.global&&0==q.active++&&u(e,null,"ajaxStart")}function s(e){e.global&&!--q.active&&u(e,null,"ajaxStop")}function c(e,t){var n=t.context;if(!1===t.beforeSend.call(n,e,t)||!1===u(t,n,"ajaxBeforeSend",[e,t]))return!1;u(t,n,"ajaxSend",[e,t])}function f(e,t,n){var r=n.context;n.success.call(r,e,"success",t),u(n,r,"ajaxSuccess",[t,n,e]),p("success",t,n)}function l(e,t,n,r){var o=r.context;r.error.call(o,n,t,e),u(r,o,"ajaxError",[n,r,e]),p(t,n,r)}function p(e,t,n){var r=n.context;n.complete.call(r,t,e),u(n,r,"ajaxComplete",[t,n]),s(n)}function d(){}function y(e){return e&&(e==N?"html":e==R?"json":j.test(e)?"script":O.test(e)&&"xml")||"text"}function h(e,t){return(e+"&"+t).replace(/[&?]{1,2}/,"?")}function b(e){"object"===v(e.data)&&(e.data=(0,_.param)(e.data)),!e.data||e.type&&"GET"!=e.type.toUpperCase()||(e.url=h(e.url,e.data))}var m,E,v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w=n(5),g=function(e){return e&&e.__esModule?e:{default:e}}(w),_=n(6),x=0,T="undefined"==typeof window,S=!T&&window.document,j=/^(?:text|application)\/javascript/i,O=/^(?:text|application)\/xml/i,R="application/json",N="text/html",M=/^\s*$/,q=e.exports=function(e){var t=Object.assign({},e||{});for(m in q.settings)void 0===t[m]&&(t[m]=q.settings[m]);a(t),t.crossDomain||(t.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(t.url)&&!T&&!!window.location&&RegExp.$2!=window.location.host);var n=t.dataType,i=/=\?/.test(t.url);if("jsonp"==n||i)return i||(t.url=h(t.url,"callback=?")),q.JSONP(t);t.url||(t.url=!T&&!!window.location&&window.location.toString()),b(t);var u,s=t.accepts[n],p={},v=/^([\w-]+:)\/\//.test(t.url)?RegExp.$1:!T&&!!window.location&&window.location.protocol,w=q.settings.xhr();t.crossDomain?"undefined"!=typeof XDomainRequest&&(w=new XDomainRequest,w.onload=function(){w.readyState=4,w.status=200,w.onreadystatechange()},w.error=function(){w.readyState=4,w.status=400,w.onreadystatechange()}):p["X-Requested-With"]="XMLHttpRequest",s&&(p.Accept=s,s.indexOf(",")>-1&&(s=s.split(",",2)[0]),w.overrideMimeType&&w.overrideMimeType(s)),(t.contentType||t.data&&"GET"!=t.type.toUpperCase())&&(p["Content-Type"]=t.contentType||"application/x-www-form-urlencoded"),t.headers=Object.assign(p,t.headers||{}),w.onreadystatechange=function(){if(4==w.readyState){clearTimeout(u);var e,i=!1;if(w.status>=200&&w.status<300||304==w.status||0==w.status&&"file:"==v){n=n||y(w.contentType||w.getResponseHeader&&w.getResponseHeader("content-type"));try{"script"==n?(0,eval)(e):e="xml"==n?w.responseXML:"json"==n?M.test(w.responseText)?null:JSON.parse(w.responseText):"arraybuffer"===n?r(w):"blob"===n?o(w):w.responseText}catch(e){i=e}i?l(i,"parsererror",w,t):f(e,w,t)}else l(null,"error",w,t)}};var g=!("async"in t)||t.async;if(w.open(t.type,t.url,g),"arraybuffer"==n||"blob"==n){"string"==typeof w.responseType?w.responseType=e.dataType:w.overrideMimeType?w.overrideMimeType("text/plain; charset=x-user-defined"):w.setRequestHeader("Accept-Charset","x-user-defined")}for(E in t.headers)w.setRequestHeader(E,t.headers[E]);return!1===c(w,t)?(w.abort(),!1):(t.timeout>0&&(u=setTimeout(function(){w.onreadystatechange=d,w.abort(),l(null,"timeout",w,t)},t.timeout)),w.send(t.data?t.data:null),w)};q.active=0,q.JSONP=function(e){if(!("type"in e))return q(e);var t,n="jsonp"+ ++x,r=S.createElement("script"),o=function(){!T&&n in window&&(window[n]=d),p("abort",i,e)},i={abort:o},u=S.getElementsByTagName("head")[0]||S.documentElement;return e.error&&(r.onerror=function(){i.abort(),e.error()}),T||(window[n]=function(r){clearTimeout(t),delete window[n],f(r,i,e)}),b(e),r.src=e.url.replace(/=\?/,"="+n),u.insertBefore(r,u.firstChild),e.timeout>0&&(t=setTimeout(function(){i.abort(),p("timeout",i,e)},e.timeout)),i},q.settings={type:"GET",beforeSend:d,success:d,error:d,complete:d,context:null,global:!0,xhr:function(){return new g.default},accepts:{script:"text/javascript, application/javascript",json:R,xml:"application/xml, text/xml",html:N,text:"text/plain"},crossDomain:!1,timeout:0},q.get=function(e,t){return q({url:e,success:t})},q.post=function(e,t,n,r){return"function"==typeof t&&(r=r||n,n=t,t=null),q({type:"POST",url:e,data:t,success:n,dataType:r})},q.getJSON=function(e,t){return q({url:e,success:t,dataType:"json"})}},function(e,t,n){"use strict";var r=n(8),o=function(e){return e&&e.__esModule?e:{default:e}}(r);"undefined"!=typeof window?window.XMLHttpRequest?e.exports=window.XMLHttpRequest:console.warn("当前浏览器不支持XMLHttpRequest"):"undefined"!=typeof XMLHttpRequest?e.exports=XMLHttpRequest:e.exports=o.default.XMLHttpRequest||o.default},function(e,t,n){"use strict";function r(e,t,n,o){var u=t instanceof Array;Object.keys(t).forEach(function(a){var s=t[a];o&&(a=n?o:"scope["+(u?"":a)+"]"),!o&&u?e.add(s.name,s.value):(n?s instanceof Array:"object"===(void 0===s?"undefined":i(s)))?r(e,s,n,a):e.add(a,s)})}function o(e,t){var n=[];return n.add=function(e,t){this.push(encodeURIComponent(e)+"="+encodeURIComponent(t))},r(n,e,t),n.join("&").replace("%20","+")}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.serialize=r,t.param=o},,function(e,t){}])});